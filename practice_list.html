<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Practices Network - Dental Laboratory</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #BCDDE4;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #EDEDED;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #197CAE 0%, #003049 100%);
            padding: 30px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 600;
        }

        .header p {
            opacity: 0.9;
            margin-top: 5px;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .content {
            padding: 30px;
        }

        .search-bar {
            background: white;
            border: 2px solid transparent;
            border-radius: 25px;
            padding: 15px 20px;
            margin-bottom: 30px;
            font-size: 16px;
            width: 100%;
            transition: all 0.3s ease;
        }

        .search-bar:focus {
            outline: none;
            border-color: #197CAE;
            box-shadow: 0 0 0 3px rgba(25, 124, 174, 0.1);
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: #197CAE;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 48, 73, 0.1);
        }

        .stat-number {
            font-size: 28px;
            font-weight: bold;
            color: #197CAE;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #003049;
            font-size: 14px;
        }

        .add-practice-btn {
            background: linear-gradient(135deg, #197CAE 0%, #003049 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .add-practice-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(25, 124, 174, 0.3);
            background: linear-gradient(135deg, #003049 0%, #197CAE 100%);
        }

        .practices-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 25px;
        }

        .practice-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 48, 73, 0.08);
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .practice-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 48, 73, 0.15);
            border-color: #197CAE;
        }

        .practice-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .practice-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #197CAE 0%, #003049 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin-right: 15px;
        }

        .practice-info h3 {
            font-size: 20px;
            font-weight: 600;
            color: #003049;
            margin-bottom: 5px;
        }

        .practice-company {
            font-size: 14px;
            color: #197CAE;
            font-style: italic;
            margin-bottom: 5px;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .practice-details {
            margin-bottom: 20px;
        }

        .detail-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            font-size: 14px;
        }

        .detail-icon {
            width: 20px;
            margin-right: 10px;
            text-align: center;
        }

        .detail-label {
            font-weight: 500;
            color: #003049;
            min-width: 60px;
        }

        .detail-value {
            color: #003049;
            flex: 1;
        }

        .contact-link {
            color: #197CAE;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .contact-link:hover {
            color: #003049;
            text-decoration: underline;
        }

        .practice-actions {
            display: flex;
            justify-content: center;
        }

        .action-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #197CAE;
            color: white;
        }

        .action-btn:hover {
            transform: translateY(-1px);
            opacity: 0.9;
        }

        .no-results {
            text-align: center;
            padding: 50px;
            color: #003049;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            padding: 20px;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: #EDEDED;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            background: linear-gradient(135deg, #197CAE 0%, #003049 100%);
            padding: 25px 30px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-size: 24px;
            font-weight: 600;
            margin: 0;
        }

        .modal-header p {
            opacity: 0.9;
            margin-top: 5px;
            font-size: 14px;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .modal-body {
            padding: 30px;
        }

        .modal-form-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .modal-form-section:hover {
            border-color: #197CAE;
        }

        .modal-form-section h3 {
            color: #003049;
            font-size: 18px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            display: block;
            font-weight: 500;
            color: #003049;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            color: #003049;
            background: white;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: #197CAE;
            box-shadow: 0 0 0 3px rgba(25, 124, 174, 0.1);
        }

        .modal-form-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            padding: 25px;
            background: white;
            border-radius: 15px;
        }

        .input-hint {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }

        .modal-success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .modal-error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            min-width: 120px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #197CAE 0%, #003049 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(25, 124, 174, 0.4);
        }

        .btn-secondary {
            background: transparent;
            color: #197CAE;
            border: 2px solid #197CAE;
        }

        .btn-secondary:hover {
            background: #197CAE;
            color: white;
            transform: translateY(-2px);
        }

        .required {
            color: #e74c3c;
        }

        .practice-icon {
            width: 20px;
            height: 20px;
            display: inline-block;
        }

        @media (max-width: 768px) {
            .practices-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .practice-header {
                flex-direction: column;
                text-align: center;
            }
            
            .practice-avatar {
                margin-right: 0;
                margin-bottom: 15px;
            }

            .modal-content {
                margin: 10px;
                max-height: 95vh;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .modal-form-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <h1>üè• Practices Network</h1>
                <p>Manage your dental practice partners</p>
            </div>
            <button class="back-btn" onclick="goBack()">‚Üê Back to Dashboard</button>
        </div>

        <div class="content">
            <input type="text" class="search-bar" placeholder="üîç Search practices by name, company, email, or location..." 
                   onkeyup="searchPractices(this.value)">

            <!-- Stats Bar -->
            <div class="stats-bar">
                <div class="stat-card">
                    <div class="stat-number" id="totalPractices">6</div>
                    <div class="stat-label">Total Practices</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="activePractices">6</div>
                    <div class="stat-label">Active Partners</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalDoctors">24</div>
                    <div class="stat-label">Total Doctors</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="recentWork">18</div>
                    <div class="stat-label">Recent Cases</div>
                </div>
            </div>

            <button class="add-practice-btn" onclick="addNewPractice()">
                ‚ûï Add New Practice
            </button>

            <div class="practices-grid" id="practicesGrid">
                <!-- Practices will be loaded here -->
            </div>

            <div class="no-results" id="noResults" style="display: none;">
                <h3>No practices found</h3>
                <p>Try adjusting your search criteria or add a new practice</p>
            </div>
        </div>
    </div>

    <!-- Add New Practice Modal -->
    <div class="modal-overlay" id="newPracticeModal">
        <div class="modal-content">
            <div class="modal-header">
                <div>
                    <h2>‚ûï Add New Practice</h2>
                    <p>Register a new dental practice to our network</p>
                </div>
                <button class="modal-close" onclick="closeNewPracticeModal()">‚úï Close</button>
            </div>

            <div class="modal-body">
                <div class="modal-success-message" id="modalSuccessMessage">
                    ‚úÖ Practice registered successfully!
                </div>

                <div class="modal-error-message" id="modalErrorMessage">
                    ‚ùå Please check the form for errors and try again.
                </div>

                <form id="newPracticeForm">
                    <div class="modal-form-section">
                        <h3>
                            <svg class="practice-icon" viewBox="0 0 24 24" fill="#197CAE">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                            Practice Information
                        </h3>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Practice Name <span class="required">*</span></label>
                                <input type="text" id="newPracticeName" name="name" placeholder="Enter practice name" required maxlength="1024" class="form-input">
                                <div class="input-hint">Required field - Maximum 1024 characters</div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Company Name <span class="required">*</span></label>
                                <input type="text" id="newCompanyName" name="companyName" placeholder="Enter company name" required maxlength="1024" class="form-input">
                                <div class="input-hint">Legal company name</div>
                            </div>

                            <div class="form-group full-width">
                                <label class="form-label">Address <span class="required">*</span></label>
                                <input type="text" id="newAddress" name="address" placeholder="Enter complete practice address" required maxlength="200" class="form-input">
                                <div class="input-hint">Complete address including street, city, state, zip</div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Phone Number <span class="required">*</span></label>
                                <input type="tel" id="newPhone" name="phone" placeholder="(555) 123-4567" required maxlength="100" class="form-input">
                                <div class="input-hint">Primary practice contact number</div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Email Address</label>
                                <input type="email" id="newEmail" name="email" placeholder="practice@example.com" maxlength="1024" class="form-input">
                                <div class="input-hint">Practice email for communication</div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Tax ID</label>
                                <input type="text" id="newTaxId" name="taxId" placeholder="Enter tax identification number" maxlength="1024" class="form-input">
                                <div class="input-hint">Federal Tax ID or EIN</div>
                            </div>
                        </div>
                    </div>

                    <div class="modal-form-section">
                        <h3>
                            <svg class="practice-icon" viewBox="0 0 24 24" fill="#197CAE">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                            Operations & Services
                        </h3>
                        
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label class="form-label">Opening Hours</label>
                                <input type="text" id="newOpeningHours" name="openingHours" placeholder="e.g., Mon-Fri: 8:00 AM - 6:00 PM, Sat: 9:00 AM - 2:00 PM" maxlength="100" class="form-input">
                                <div class="input-hint">Practice operating hours and days</div>
                            </div>

                            <div class="form-group full-width">
                                <label class="form-label">Delivery Method</label>
                                <input type="text" id="newDeliveryMethod" name="deliveryMethod" placeholder="e.g., Pickup only, Courier service, Mail delivery, etc." maxlength="200" class="form-input">
                                <div class="input-hint">How lab work will be delivered to/from practice (Maximum 200 characters)</div>
                            </div>
                        </div>
                    </div>

                    <div class="modal-form-actions">
                        <button type="button" class="btn btn-secondary" onclick="resetNewPracticeForm()">
                            üîÑ Reset Form
                        </button>
                        <button type="submit" class="btn btn-primary">
                            ‚úÖ Register Practice
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Sample practices data
        let practices = [
            {
                PracticeID: 1,
                Name: "Sunshine Dental Care",
                CompanyName: "Sunshine Medical Group LLC",
                Address: "123 Healthcare Plaza, Suite 200, Medical District, CA 90210",
                Phone: "(555) 123-4567",
                Email: "contact@sunshinedental.com",
                TaxID: "12-3456789",
                OpeningHours: "Monday - Friday: 8:00 AM - 6:00 PM, Saturday: 9:00 AM - 2:00 PM, Sunday: Closed",
                DeliveryMethod: "Courier service (daily pickup/delivery), Emergency pickup available 24/7",
                PartnerSince: "2019-03-15",
                Status: "Active",
                Doctors: 4,
                RecentCases: 12
            },
            {
                PracticeID: 2,
                Name: "Downtown Dental Clinic",
                CompanyName: "Downtown Dental Services Inc.",
                Address: "456 Main Street, Downtown, CA 90211",
                Phone: "(555) 234-5678",
                Email: "info@downtowndental.com",
                TaxID: "23-4567890",
                OpeningHours: "Monday - Friday: 7:30 AM - 7:00 PM, Saturday: 8:00 AM - 4:00 PM",
                DeliveryMethod: "Pickup and delivery service, Same-day rush available",
                PartnerSince: "2020-01-20",
                Status: "Active",
                Doctors: 6,
                RecentCases: 18
            },
            {
                PracticeID: 3,
                Name: "Elite Smile Center",
                CompanyName: "Elite Dental Group LLC",
                Address: "789 Professional Blvd, Suite 100, Westside, CA 90212",
                Phone: "(555) 345-6789",
                Email: "contact@elitesmile.com",
                TaxID: "34-5678901",
                OpeningHours: "Monday - Thursday: 8:00 AM - 5:00 PM, Friday: 8:00 AM - 3:00 PM",
                DeliveryMethod: "Weekly scheduled pickup, Express service available",
                PartnerSince: "2021-06-10",
                Status: "Active",
                Doctors: 3,
                RecentCases: 8
            },
            {
                PracticeID: 4,
                Name: "Perfect Teeth Practice",
                CompanyName: "Perfect Dental Solutions Inc.",
                Address: "321 Dental Way, Suite 300, Eastside, CA 90213",
                Phone: "(555) 456-7890",
                Email: "admin@perfectteeth.com",
                TaxID: "45-6789012",
                OpeningHours: "Monday - Friday: 9:00 AM - 6:00 PM, Saturday: 9:00 AM - 1:00 PM",
                DeliveryMethod: "Bi-weekly pickup service, Emergency delivery available",
                PartnerSince: "2022-02-14",
                Status: "Active",
                Doctors: 5,
                RecentCases: 15
            },
            {
                PracticeID: 5,
                Name: "Advanced Dental Care",
                CompanyName: "Advanced Dental Specialists LLC",
                Address: "654 Innovation Drive, Tech Park, CA 90214",
                Phone: "(555) 567-8901",
                Email: "info@advancedcare.com",
                TaxID: "56-7890123",
                OpeningHours: "Monday - Friday: 8:00 AM - 6:00 PM",
                DeliveryMethod: "Daily courier service, Digital workflow integration",
                PartnerSince: "2021-11-30",
                Status: "Active",
                Doctors: 4,
                RecentCases: 10
            },
            {
                PracticeID: 6,
                Name: "Family Care Dental",
                CompanyName: "Family Dental Services Corp.",
                Address: "987 Family Circle, Suburb Heights, CA 90215",
                Phone: "(555) 678-9012",
                Email: "contact@familycare.com",
                TaxID: "67-8901234",
                OpeningHours: "Monday - Saturday: 8:00 AM - 5:00 PM",
                DeliveryMethod: "Three times weekly pickup, Family-friendly scheduling",
                PartnerSince: "2020-08-05",
                Status: "Active",
                Doctors: 2,
                RecentCases: 6
            }
        ];

        let displayedPractices = [...practices];

        function renderPractices(practicesToRender) {
            const grid = document.getElementById('practicesGrid');
            const noResults = document.getElementById('noResults');
            
            if (practicesToRender.length === 0) {
                grid.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }
            
            grid.style.display = 'grid';
            noResults.style.display = 'none';
            
            grid.innerHTML = practicesToRender.map(practice => `
                <div class="practice-card">
                    <div class="practice-header">
                        <div class="practice-avatar">
                            ${getInitials(practice.Name)}
                        </div>
                        <div class="practice-info">
                            <h3>${practice.Name}</h3>
                            <div class="practice-company">${practice.CompanyName}</div>
                            <div class="status-badge status-active">${practice.Status}</div>
                        </div>
                    </div>
                    
                    <div class="practice-details">
                        <div class="detail-row">
                            <span class="detail-icon">üìç</span>
                            <span class="detail-label">Address:</span>
                            <span class="detail-value">${practice.Address}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-icon">üìß</span>
                            <span class="detail-label">Email:</span>
                            <span class="detail-value">
                                <a href="mailto:${practice.Email}" class="contact-link">${practice.Email}</a>
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-icon">üìû</span>
                            <span class="detail-label">Phone:</span>
                            <span class="detail-value">
                                <a href="tel:${practice.Phone}" class="contact-link">${practice.Phone}</a>
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-icon">üìÖ</span>
                            <span class="detail-label">Partner Since:</span>
                            <span class="detail-value">${formatDate(practice.PartnerSince)}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-icon">üë®‚Äç‚öïÔ∏è</span>
                            <span class="detail-label">Doctors:</span>
                            <span class="detail-value">${practice.Doctors}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-icon">üìä</span>
                            <span class="detail-label">Recent Cases:</span>
                            <span class="detail-value">${practice.RecentCases}</span>
                        </div>
                    </div>
                    
                    <div class="practice-actions">
                        <button class="action-btn btn-primary" onclick="viewPracticeDetails(${practice.PracticeID})">
                            View Profile
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function updateStats() {
            const totalPractices = practices.length;
            const activePractices = practices.filter(p => p.Status === 'Active').length;
            const totalDoctors = practices.reduce((total, practice) => total + practice.Doctors, 0);
            const recentWork = practices.reduce((total, practice) => total + practice.RecentCases, 0);

            document.getElementById('totalPractices').textContent = totalPractices;
            document.getElementById('activePractices').textContent = activePractices;
            document.getElementById('totalDoctors').textContent = totalDoctors;
            document.getElementById('recentWork').textContent = recentWork;
        }

        function searchPractices(searchTerm) {
            if (!searchTerm.trim()) {
                displayedPractices = [...practices];
            } else {
                const term = searchTerm.toLowerCase();
                displayedPractices = practices.filter(practice => 
                    practice.Name.toLowerCase().includes(term) ||
                    practice.CompanyName.toLowerCase().includes(term) ||
                    practice.Email.toLowerCase().includes(term) ||
                    practice.Phone.includes(term) ||
                    practice.Address.toLowerCase().includes(term)
                );
            }
            renderPractices(displayedPractices);
        }

        function getInitials(name) {
            return name.split(' ')
                      .map(word => word.charAt(0))
                      .join('')
                      .toUpperCase()
                      .slice(0, 2);
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function addNewPractice() {
            openNewPracticeModal();
        }

        function viewPracticeDetails(practiceId) {
            const practice = practices.find(p => p.PracticeID === practiceId);
            alert(`üè• Practice Profile: ${practice.Name}\n\nFull Details:\n‚Ä¢ Company: ${practice.CompanyName}\n‚Ä¢ Email: ${practice.Email}\n‚Ä¢ Phone: ${practice.Phone}\n‚Ä¢ Address: ${practice.Address}\n‚Ä¢ Tax ID: ${practice.TaxID || 'Not provided'}\n‚Ä¢ Partner Since: ${formatDate(practice.PartnerSince)}\n‚Ä¢ Total Doctors: ${practice.Doctors}\n‚Ä¢ Recent Cases: ${practice.RecentCases}`);
        }

        function goBack() {
            alert('üè† Returning to main dashboard...');
        }

        // Modal functions
        function openNewPracticeModal() {
            document.getElementById('newPracticeModal').classList.add('show');
            document.body.style.overflow = 'hidden';
            hideModalMessages();
        }

        function closeNewPracticeModal() {
            if (hasFormData() && 
                !confirm('Are you sure you want to close? Any unsaved changes will be lost.')) {
                return;
            }
            document.getElementById('newPracticeModal').classList.remove('show');
            document.body.style.overflow = 'auto';
            resetNewPracticeForm();
        }

        function hasFormData() {
            const form = document.getElementById('newPracticeForm');
            const inputs = form.querySelectorAll('input');
            
            for (let input of inputs) {
                if (input.value.trim() !== '') {
                    return true;
                }
            }
            return false;
        }

        function resetNewPracticeForm() {
            document.getElementById('newPracticeForm').reset();
            hideModalMessages();
        }

        function hideModalMessages() {
            document.getElementById('modalSuccessMessage').style.display = 'none';
            document.getElementById('modalErrorMessage').style.display = 'none';
        }

        function showModalSuccess(message) {
            hideModalMessages();
            const successEl = document.getElementById('modalSuccessMessage');
            successEl.textContent = message || '‚úÖ Practice registered successfully!';
            successEl.style.display = 'block';
        }

        function showModalError(message) {
            hideModalMessages();
            const errorEl = document.getElementById('modalErrorMessage');
            errorEl.textContent = message || '‚ùå Please check the form for errors and try again.';
            errorEl.style.display = 'block';
        }

        function generatePracticeId() {
            return Math.max(...practices.map(p => p.PracticeID)) + 1;
        }

        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        function isValidPhone(phone) {
            return /^[\+]?[(]?[\d\s\-\(\)]{10,}$/.test(phone.replace(/\s/g, ''));
        }

        function formatPhoneNumber(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length >= 6) {
                value = value.replace(/(\d{3})(\d{3})(\d{4})/, '($1) $2-$3');
            } else if (value.length >= 3) {
                value = value.replace(/(\d{3})(\d{0,3})/, '($1) $2');
            }
            input.value = value;
        }

        // New Practice Form submission
        document.getElementById('newPracticeForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const practiceData = Object.fromEntries(formData.entries());
            
            // Basic validation
            const requiredFields = ['name', 'companyName', 'address', 'phone'];
            let isValid = true;
            let missingField = '';
            
            for (let field of requiredFields) {
                if (!practiceData[field] || practiceData[field].trim() === '') {
                    isValid = false;
                    missingField = field;
                    break;
                }
            }
            
            // Email validation (if provided)
            if (isValid && practiceData.email && !isValidEmail(practiceData.email)) {
                isValid = false;
                showModalError('‚ùå Please enter a valid email address.');
                return;
            }
            
            // Phone validation
            if (isValid && !isValidPhone(practiceData.phone)) {
                isValid = false;
                showModalError('‚ùå Please enter a valid phone number.');
                return;
            }
            
            if (isValid) {
                // Add unique ID and additional data
                const newPractice = {
                    PracticeID: generatePracticeId(),
                    Name: practiceData.name,
                    CompanyName: practiceData.companyName,
                    Address: practiceData.address,
                    Phone: practiceData.phone,
                    Email: practiceData.email || '',
                    TaxID: practiceData.taxId || '',
                    OpeningHours: practiceData.openingHours || '',
                    DeliveryMethod: practiceData.deliveryMethod || '',
                    PartnerSince: new Date().toISOString().split('T')[0],
                    Status: 'Active',
                    Doctors: 0,
                    RecentCases: 0
                };
                
                // Simulate API call
                showModalSuccess('‚úÖ Registering practice...');
                
                setTimeout(() => {
                    // Add to practices array
                    practices.push(newPractice);
                    displayedPractices = [...practices];
                    
                    // Log the data
                    console.log('New practice data to be saved:', newPractice);
                    
                    // Re-render practices and update stats
                    renderPractices(displayedPractices);
                    updateStats();
                    
                    showModalSuccess(`‚úÖ ${newPractice.Name} has been successfully registered!`);
                    
                    // Close modal after success
                    setTimeout(() => {
                        closeNewPracticeModal();
                    }, 2000);
                    
                }, 1500);
            } else {
                showModalError(`‚ùå Please fill in the required field: ${missingField.replace(/([A-Z])/g, ' $1').toLowerCase()}.`);
            }
        });

        // Add phone formatting
        document.getElementById('newPhone').addEventListener('input', function() {
            formatPhoneNumber(this);
        });

        // Close modal when clicking outside
        document.getElementById('newPracticeModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeNewPracticeModal();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && document.getElementById('newPracticeModal').classList.contains('show')) {
                closeNewPracticeModal();
            }
        });

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            renderPractices(displayedPractices);
            updateStats();
        });
    </script>
</body>
</html>